<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>PowerShell on IvoBeerens.NL | All about End User Computing, AVD, W365 and Infrastructure as Code (IaC)</title><link>/tags/powershell/</link><description>Recent content in PowerShell on IvoBeerens.NL | All about End User Computing, AVD, W365 and Infrastructure as Code (IaC)</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 24 Feb 2024 09:43:55 +0100</lastBuildDate><atom:link href="/tags/powershell/index.xml" rel="self" type="application/rss+xml"/><item><title>List the parent VM and active snapshot per VMware Horizon pool</title><link>/2020/09/21/list-the-parent-and-active-snapshot-per-vmware-horizon-pool/</link><pubDate>Mon, 21 Sep 2020 15:02:44 +0000</pubDate><guid>/2020/09/21/list-the-parent-and-active-snapshot-per-vmware-horizon-pool/</guid><description>On my GitHub page (link ), I uploaded a PowerShell script that identifies all the active parent VM and snapshot per VMware Horizon pool. The parent VM is also known as Golden image.
With this script, you can quickly identify what parent VMs and snapshots are in use.</description></item><item><title>VIBSearch Finding VIB versions</title><link>/2014/12/17/vibsearch-finding-vib-versions/</link><pubDate>Wed, 17 Dec 2014 09:28:56 +0000</pubDate><guid>/2014/12/17/vibsearch-finding-vib-versions/</guid><description>VIBSearch is a simple PowerShell script with a GUI that will search for a specified VIB or all the VIBS installed on the ESXi hosts. A VIB stands for vSphere Installation Bundle (VIB). VIBs are used to package and distribute ESXi software such as drivers. The GUI is designed with SAPIEN PowerShell Studio 2014.
With VIBSearch it is easily to verify that all the ESXi host in the cluster have the same VIB versions installed.</description></item><item><title>Hyper-V Get Snapshot checkpoint file sizes on Cluster Shared Volumes with PowerShell</title><link>/2013/09/17/list-hyper-v-snapshot-file-sizes-on-cluster-shared-volumes-with-powershell/</link><pubDate>Tue, 17 Sep 2013 13:39:07 +0000</pubDate><guid>/2013/09/17/list-hyper-v-snapshot-file-sizes-on-cluster-shared-volumes-with-powershell/</guid><description>During a Windows Server 2012 Hyper-V Health Check I needed to know the snapshot file sizes for the all the snapshots on the Clustered Shared Volumes (CSVs). The Get-VMCheckpoint Cmdlet does not report the snapshot size. So I create a PowerShell one-liner that displays the following information:
Location of the snapshot file Date and time that the snapshot file was created Last write access time of the snapshot file File size in MBs The PowerShell one-liner is executed from a Hyper-V 2012 host that has access to all the Cluster Shared Volumes (CSVs).</description></item><item><title>Health Check your System Center Virtual Machine Server (SCVMM) 2012 environent with PowerShell</title><link>/2013/01/28/health-check-your-system-center-virtual-machine-server-scvmm-2012-environent-with-powershell/</link><pubDate>Mon, 28 Jan 2013 10:07:16 +0000</pubDate><guid>/2013/01/28/health-check-your-system-center-virtual-machine-server-scvmm-2012-environent-with-powershell/</guid><description>Last week I created a simple example of a HealtCheck PowerShell script that connects to Microsoft System Center Virtual Machine Manager and displays information about the Hyper-V hosts and VMs managed by this server.
I run the PowerShell script from another Windows Server 2012 host. To make this work make sure the Hyper-V manager and the VMM Console is installed on the server. The VMM console can be installed from the Microsoft System Center 2012 Virtual Machine Manager ISO.</description></item><item><title>Identify NICs in Hyper-V 2012</title><link>/2012/03/26/identify-nics-in-windows-server-8-hyper-v/</link><pubDate>Mon, 26 Mar 2012 12:49:11 +0000</pubDate><guid>/2012/03/26/identify-nics-in-windows-server-8-hyper-v/</guid><description>In a Hyper-V cluster are normally a lot of NICs involved. Identifying the right can be challenging. It is important to consequently label your network adapters on all the servers in the Hyper-V cluster.
In Windows Server 2012 there are PowerShell Cmdlets that can be used for identifying NICs. Once you identified the NIC, rename it to meaningful name. The PowerShell Cmdlets listed below can be executed on the following versions:</description></item><item><title>Windows Server 2012 PowerShell Cmdlets for Hyper-V help</title><link>/2012/03/07/windows-server-8-powershell-cmdlets-for-hyper-v-help/</link><pubDate>Wed, 07 Mar 2012 14:13:45 +0000</pubDate><guid>/2012/03/07/windows-server-8-powershell-cmdlets-for-hyper-v-help/</guid><description>In Windows 2008 &amp;amp; Windows2008 R2 there were no official PowerShell Cmdlets available for Hyper-V. This is changed in Windows 2012 and Windows 8. Windows Server 2012 and 8 has 162 or more PowerShell Cmdlets available for Hyper-V. Windows 8 uses PowerShell version 3.
Cmdlets are very powerful, that lets you automate all aspects of Hyper-V. Here some guidance how-to find the Cmdlets you need.
To view all the Hyper-V PowerShell Cmdlets:</description></item><item><title>List VM settings to CSV, HTML, gridview, screen and email</title><link>/2011/06/09/powercli-list-vm-settings-and-export-to-csv-html-gridview-screen-and-email/</link><pubDate>Thu, 09 Jun 2011 10:47:47 +0000</pubDate><guid>/2011/06/09/powercli-list-vm-settings-and-export-to-csv-html-gridview-screen-and-email/</guid><description>This PowerCLI script will display specified VM settings for all VMs in the vCenter server you specify. If you do an inventory, a health check or need to troubleshoot VMware environment this PowerCLI script can be useful.
The following VM settings will be displayed:
VMName, Hostname, IP address, OS version, Boottime, VMstate, Total vCPUs, CPU afinnity, CPU hot add status, CPU share, CPU limit, Overall CPU usage, CPU reservation, Total memory, Memory share, Memory usage, Memory hot add status, Memory limit, Memory reservation, Memory swap, Memory ballooning, Memory compression, Total NICs, VMware tools status, VMware Tools version, VM hardware version, Timesync status and CBT status.</description></item><item><title>VMware ESX Post installation configuration via PowerCLI</title><link>/2010/02/10/vmware-esx-post-installation-configuration-via-powercli/</link><pubDate>Wed, 10 Feb 2010 14:36:55 +0000</pubDate><guid>/2010/02/10/vmware-esx-post-installation-configuration-via-powercli/</guid><description>I made a simple example script using the VMware PowerCLI that can be used to do the post installation configuration of a VMware ESX 4 server. This script does the following things:
Connect to VMware ESX server Set the SC memory to 800MB Creates vSwitch2 and add vmnic2 and vmnic3 Add several PortGroups and VLANs to vSwitch2 Remove default PortGroup VM Network Creates a VMkernel VMotion port with IP address, subnetmask and VLAN Add vmnic0 and vmnic1 to vSwitch0, set for the VMotion port vmnic1 active and vmnic0 standby and for the Service Console port vmnic0 active and vmnic1 standby Configure NTP servers and open the firewall Sets advanced settings Disk.</description></item><item><title>PowerShell Windows Eventlog script</title><link>/2009/02/03/powershell-windows-eventlog-script/</link><pubDate>Tue, 03 Feb 2009 18:44:06 +0000</pubDate><guid>/2009/02/03/powershell-windows-eventlog-script/</guid><description>Here a new PowerShell report-event script.
figure 1. Output reports-event script
You can specify multiple servers in a text file, select how many hours from the current time to look in the eventlog and e-mail the HTML file after generation. The following syntax can be used:
get-content c:\\script\\servers.txt | c:\\scripts\\report-event.ps1 – report c:\\script\\eventlog.html –hours 48 –smtp mail.beerenss.nl –sendto [eventlogs@beerens.nl](mailto:ivo@ivobeerens.nl) –from [eventlog@beerens.nl](mailto:eventlog@ivobeerens.nl) Explanation:
get-content c:\script\servers.txt, text file containing the server names</description></item><item><title>Winners VI toolkit scripting contest</title><link>/2008/09/09/winners-vi-toolkit-scripting-contest/</link><pubDate>Tue, 09 Sep 2008 13:31:07 +0000</pubDate><guid>/2008/09/09/winners-vi-toolkit-scripting-contest/</guid><description>The winners of the VI Toolkit scripting contest are announced:
The first prize goes to LucD Dekens for his Guest Provisioning System script. The Second prize goes to tzamora for his VMware Infrastructure Power Documenter script. The Third prize goes to Dan Baskette with his PowerVDI script. The VMware Healthcheck script that I created has not won. Congrats to all the contest winners! You can read the rest @ the VMware PowerShell Blog</description></item><item><title>VI Toolkit Update 1 released</title><link>/2008/09/05/vi-toolkit-update-1-released/</link><pubDate>Fri, 05 Sep 2008 18:21:08 +0000</pubDate><guid>/2008/09/05/vi-toolkit-update-1-released/</guid><description>VMware has released VI Toolkit Update 1. There where performance problems with the get-VM command.
Some users had reported slowness when using the Get-VM cmdlet . The reason turned out to be an odd quirk in querying some types of network adapters, so many people weren&amp;rsquo;t affected at all. On the other hand, if you were affected, it was pretty annoying. To address this we&amp;rsquo;ve released Update 1 of our toolkit .</description></item><item><title>VMware PowerShell Healthcheck script</title><link>/2008/08/28/VMware-PowerShell-healthcheck-script/</link><pubDate>Thu, 28 Aug 2008 12:57:27 +0000</pubDate><guid>/2008/08/28/VMware-PowerShell-healthcheck-script/</guid><description>Healthcheck is a PowerShell script that reports information like snapshots, VMware tools version, datastore space, CDROM and/or floppy drives connected etc. to HTML and e-mail the output to a person or distribution list.
Reason for creating this script:
As VMware Consultant I see a lot of common problems in VMware environments like:
Snapshots are enabled and forgot Datastores are almost full (for example if snapshots are enabled) VMware tools versions are different CDROM and floppy drives are still mounted to the VM Virtual Machines have CPU and Memory limits or reservations (VMs are swapping) In the VM, the VMware Tools timesync option is not enabled In the Virtual Infrastructure Client (VIC) it is difficult to see this sort of information.</description></item></channel></rss>